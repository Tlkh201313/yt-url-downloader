[Content from pastecontent.txt]
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber YouTube Downloader</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'background': '#0a0e27',
                        'foreground': '#e6f0ff',
                        'card': '#1a1f3a',
                        'primary': '#00ffff', // Bright Cyan
                        'primary-foreground': '#0a0e27',
                        'secondary': '#a020f0', // Purple Neon
                        'secondary-foreground': '#0a0e27',
                        'muted': '#2a2f4a',
                        'muted-foreground': '#94b3c4',
                        'accent': '#ff33d1', // Pink Neon
                        'accent-foreground': '#0a0e27',
                        'destructive': '#cd3a2f',
                        'border': '#2a2f4a',
                        'input': '#1a1f3a',
                        'ring': '#00ffff',
                    },
                }
            }
        }
    </script>
    
    <style>
        /* Root variables for easier color management */
        :root {
            --color-primary: #00ffff;
            --color-secondary: #a020f0;
            --color-accent: #ff33d1;
            --color-background: #0a0e27;
            --color-foreground: #e6f0ff;
            --color-input: #1a1f3a;
            --color-border: #2a2f4a;
        }

        /* Enhanced body styling */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            letter-spacing: 0.5px;
        }

        /* Animated gradient background with multiple layers */
        @keyframes gradient-shift {
            0%, 100% { 
                background-position: 0% 50%;
            }
            50% { 
                background-position: 100% 50%;
            }
        }

        @keyframes scanline-animation {
            0% {
                transform: translateY(-100%);
            }
            100% {
                transform: translateY(100vh);
            }
        }

        @keyframes pulse-glow {
            0%, 100% {
                opacity: 1;
                filter: brightness(1);
            }
            50% {
                opacity: 0.85;
                filter: brightness(1.15);
            }
        }

        .cyber-gradient {
            background: linear-gradient(
                -45deg,
                #0a0e27,
                #1a1f3a,
                #2a2f4a,
                #1a1f3a,
                #0a0e27
            );
            background-size: 400% 400%;
            animation: gradient-shift 20s ease infinite;
            position: relative;
            overflow: hidden;
        }

        /* Scanline overlay effect */
        .cyber-gradient::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(
                to bottom,
                transparent,
                rgba(0, 255, 255, 0.3),
                transparent
            );
            animation: scanline-animation 8s linear infinite;
            pointer-events: none;
            z-index: 9999;
        }

        /* Grid pattern overlay */
        .cyber-gradient::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(0deg, transparent 24%, rgba(0, 255, 255, 0.05) 25%, rgba(0, 255, 255, 0.05) 26%, transparent 27%, transparent 74%, rgba(0, 255, 255, 0.05) 75%, rgba(0, 255, 255, 0.05) 76%, transparent 77%, transparent),
                linear-gradient(90deg, transparent 24%, rgba(0, 255, 255, 0.05) 25%, rgba(0, 255, 255, 0.05) 26%, transparent 27%, transparent 74%, rgba(0, 255, 255, 0.05) 75%, rgba(0, 255, 255, 0.05) 76%, transparent 77%, transparent);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 1;
        }

        /* Enhanced cyber glow effect */
        .cyber-glow {
            box-shadow: 
                0 0 5px rgba(0, 255, 255, 0.3),
                0 0 10px rgba(0, 255, 255, 0.5),
                0 0 20px rgba(0, 255, 255, 0.3),
                0 0 40px rgba(0, 255, 255, 0.1),
                inset 0 0 10px rgba(0, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .cyber-glow:hover {
            box-shadow: 
                0 0 8px rgba(0, 255, 255, 0.5),
                0 0 15px rgba(0, 255, 255, 0.7),
                0 0 30px rgba(0, 255, 255, 0.4),
                0 0 50px rgba(0, 255, 255, 0.2),
                inset 0 0 15px rgba(0, 255, 255, 0.15);
        }
        
        /* Button style updates for better visibility */
        #btn_fetch {
            /* Increased contrast and shadow for primary button */
            background: linear-gradient(135deg, #00ffff, #00cccc);
            border: 3px solid #00ffff; 
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5), inset 0 0 8px #00ffff88;
        }
        
        #btn_download {
            /* Increased contrast and shadow for secondary button */
            background: linear-gradient(135deg, #a020f0, #8010d0);
            border: 3px solid #ff33d1; /* Use accent pink for high contrast border */
            box-shadow: 0 0 15px rgba(255, 51, 209, 0.5), inset 0 0 8px #a020f088;
        }

        /* Enhanced select box styling (kept from previous version) */
        .cyber-select {
            background-color: var(--color-input);
            color: var(--color-foreground);
            border: 2px solid var(--color-primary);
            padding: 0.75rem 2.5rem 0.75rem 1rem;
            border-radius: 0.25rem;
            box-shadow: 
                inset 0 0 10px rgba(0, 255, 255, 0.1),
                0 0 10px rgba(0, 255, 255, 0.2);
            height: 3rem;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2300ffff' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem top 50%;
            background-size: 1.2em auto;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        /* Title styling */
        h1 {
            text-shadow: 
                0 0 10px rgba(0, 255, 255, 0.5),
                0 0 20px rgba(0, 255, 255, 0.3);
            animation: pulse-glow 3s ease-in-out infinite;
        }

        /* Ad Banner Style */
        .ad-banner {
            height: 100px;
            background-color: #000033;
            border: 3px solid #ff33d1;
            box-shadow: 0 0 15px #ff33d155, inset 0 0 10px #00ffff1a;
            text-shadow: 0 0 5px #ff33d1;
            letter-spacing: 1.5px;
        }

        /* Progress Bar Animation (Both Fetch and Download use this) */
        @keyframes loading-stripes {
            0% { background-position: 1rem 0; }
            100% { background-position: 0 0; }
        }
        .loading-progress {
            background-color: theme('colors.muted');
            background-image: linear-gradient(
                -45deg, 
                theme('colors.primary') 25%, 
                transparent 25%, 
                transparent 50%, 
                theme('colors.primary') 50%, 
                theme('colors.primary') 75%, 
                transparent 75%, 
                transparent
            );
            background-size: 1rem 1rem;
            animation: loading-stripes 0.5s linear infinite;
        }
    </style>

    <script>
        // Function to extract YouTube Video ID from URL
        function getVideoId(url) {
            const match = url.match(/(?:youtu\.be\/|youtube\.com\/(?:watch\?.*v=|embed\/|v\/)|gaming\.youtube\.com\/watch\?.*v=)([^&]+)/i);
            return (match && match[1]) ? match[1] : null;
        }

        $(function () {
            // Function to enable/disable UI elements
            function setUIState(isDisabled) {
                $("#btn_fetch, #btn_download, #txt_url, #select_format").attr('disabled', isDisabled);
                if (isDisabled) {
                    $("#btn_download").removeClass('cyber-glow');
                    $("#video_info_box").hide(); 
                    $("#fetch_progress").show(); 
                } else {
                    $("#fetch_progress").hide(); 
                }
            }
            
            // Function to show/hide download indicator separately
            function setDownloadIndicator(isVisible) {
                if (isVisible) {
                    $("#download_progress").show();
                    $("#download_progress_text").text("Download preparing on server...");
                } else {
                    $("#download_progress").hide();
                    $("#download_progress_text").text("");
                }
            }


            // --- FETCH VIDEO INFORMATION ---
            $("#btn_fetch").click(function (e) {
                e.preventDefault(); 
                let url = $("#txt_url").val();
                
                if (!url) {
                    alert('Please paste a video URL.');
                    return;
                }
    
                $("#select_format").html('<option value="">Fetching formats...</option>');
                setUIState(true);
                setDownloadIndicator(false); // Hide download progress when starting fetch

                // Encode the URL before sending it
                $.get('./video_info.php?video_url=' + encodeURIComponent(url), function (data) {
                    setUIState(false);
                  
                    if (typeof data === 'string') {
                        try {
                            data = JSON.parse(data);
                        } catch (err) {
                            alert('Error: Failed to parse server response. A syntax error may exist in video_info.php.');
                            console.error("Failed to parse JSON:", data);
                            $("#select_format").html('<option value="">Parsing failed</option>');
                            return;
                        }
                    }
                    
                    // Handle the clean error response from video_info.php
                    if (data.error) {
                        alert('Server Error: ' + data.error + (data.details ? "\nDetails: " + data.details : ""));
                        $("#select_format").html('<option value="">' + data.error + '</option>');
                        $("#video_info_box").hide();
                        return;
                    }

                    let formats = data.formats;
                    let videoId = getVideoId(url);
                    let videoTitle = data.title || 'video';
                    // --- DISPLAY THUMBNAIL AND TITLE ---
                    if (videoId) {
                        let thumbnailUrl = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
                        $("#video_info_box").html(`
                            <div class="flex items-start space-x-4">
                                <img src="${thumbnailUrl}" alt="Video Thumbnail" class="w-32 h-20 object-cover border-2 border-primary/50 shadow-md">
                                <div class="flex-grow">
                                    <p class="text-primary text-md font-semibold mb-1 truncate">${videoTitle}</p>
                                    <a href="${url}" target="_blank" class="text-accent text-xs hover:underline">${url}</a>
                                </div>
                            </div>
                        `).show();
                    } else {
                        $("#video_info_box").html(`<p class="text-primary text-sm font-semibold">Title: ${videoTitle}</p>`).show();
                    }
                    // --- END DISPLAY ---


                    if (!formats || formats.length === 0) {
                        alert('No usable video formats were found!');
                        $("#select_format").html('<option value="">No formats found</option>');
                        return;
                    }

                    let formatOptions = '<option value="">Select a format...</option>';
                    // Filter and display formats
                    formats.forEach(function(f) {
                        if (!f.format_id || f.vcodec === 'none' && f.acodec === 'none' || f.downloader_options) {
                            return;
                        }
                        
                        let size = f.filesize ? (f.filesize / 1024 / 1024).toFixed(2) + ' MB' : (f.filesize_approx ? ' ~' + (f.filesize_approx / 1024 / 1024).toFixed(2) + ' MB' : ' (Size unknown)');
                        
                        let resolution;
                        if (f.vcodec !== 'none' && f.height) {
                            resolution = f.height + 'p';
                        } else if (f.acodec !== 'none') {
                            resolution = 'Audio Only';
                        } else {
                            resolution = 'Stream Only';
                        }

                        let codec = f.ext ? f.ext.toUpperCase() : 'Unknown';

                        let optionText = `${codec} - ${resolution} [${size}] - ID: ${f.format_id}`;
                        
                        formatOptions += `<option value="${f.format_id}" data-url="${encodeURIComponent(url)}" data-filename="${encodeURIComponent(videoTitle)}">${optionText}</option>`;
                    });

                    $('#select_format').html(formatOptions);
                    $("#btn_download").addClass('cyber-glow');
                }).fail(function(jqXHR, textStatus, errorThrown) {
                    setUIState(false);
                    $("#video_info_box").hide();
                    alert(`Failed to connect to the service. Status: ${textStatus}, Error: ${errorThrown}. Ensure Docker is running.`);
                    $("#select_format").html('<option value="">Connection error</option>');
                });
            });
            // --- DOWNLOAD SELECTED FORMAT ---
            $("#btn_download").click(function (e) {
                e.preventDefault();
                let selectedOption = $("#select_format option:selected");
                let formatId = selectedOption.val();
                let videoUrl = selectedOption.data('url');
                let filename = selectedOption.data('filename');
                
                if (!formatId) {
                    alert('Please select a video format first.');
                    return;
                }
                
                // NEW: Show Download Indicator before starting file stream
                setDownloadIndicator(true); 

                // Construct the download link for the download.php script
                let downloadLink = `./download.php?video_url=${videoUrl}&format_id=${formatId}&filename=${filename}`;
                
                // Navigate to the download PHP script (This starts the file stream/download)
                window.location.href = downloadLink;
                // The download indicator will remain visible until the browser's download dialog appears.
                // It cannot be reliably hidden automatically after the download starts, as the browser handles the stream.
                // We'll rely on the user to see the browser dialog and the visual feedback is provided.
            });
            // Optional: Hide the download indicator if the user navigates back quickly or cancels
            // window.onfocus = function() { setDownloadIndicator(false); };
            
        });
    </script>
</head>
<body class="cyber-gradient min-h-screen p-4 flex flex-col items-center">
    
    <main class="w-full max-w-2xl mx-auto mt-12 relative z-10">
        
        <div class="ad-banner w-full text-center py-8 mb-8 rounded-lg card-enhanced flex items-center justify-center">
            <h2 class="text-xl font-mono text-accent">ADVERTISEMENT BANNER (728x90)</h2>
        </div>

        <div class="bg-card text-foreground p-8 rounded-lg shadow-xl border border-primary/50 cyber-glow card-enhanced">
            <h1 class="text-4xl font-bold mb-6 text-primary tracking-widest border-b-2 border-secondary/50 pb-4">
                CYBER DRAIN
            </h1>
            <p class="text-sm text-muted-foreground mb-6 leading-relaxed">
                Enter a YouTube URL to retrieve available download streams.
            </p>

            <div class="flex space-x-2 mb-6">
                <input id="txt_url" type="text" placeholder="Paste YouTube Video URL here" 
                       class="flex-grow p-3 bg-input border-2 border-border focus:border-primary/80 focus:ring-1 focus:ring-primary/50 rounded-sm text-foreground placeholder-muted-foreground transition duration-300">
                
                <button id="btn_fetch" 
                        class="text-primary-foreground hover:bg-primary/80 transition duration-300 px-6 py-3 rounded-sm font-semibold">
                    Fetch
                </button>
            </div>

            <div 
                id="fetch_progress" class="hidden w-full h-2.5 bg-muted rounded-full overflow-hidden mb-4">
                <div class="w-full h-full loading-progress" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            
            <div id="download_progress" class="hidden w-full bg-muted rounded-sm overflow-hidden mb-4 p-2 border border-accent/50">
                <p id="download_progress_text" class="text-accent text-sm mb-1 font-semibold">Download preparing on server...</p>
                <div class="w-full h-2 bg-muted rounded-full overflow-hidden">
                    <div class="w-full h-full loading-progress" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>


            <div id="video_info_box" class="hidden bg-muted/50 p-4 rounded-sm border border-border mb-6 card-enhanced">
            </div>


            <div class="space-y-4">
                <label for="select_format" class="text-sm font-medium text-secondary block">
                    Select Format Stream:
                </label>
                <div class="relative">
                    <select id="select_format" class="w-full cyber-select">
                        <option value="">Enter URL and click Fetch</option>
                    </select>
                </div>

                <button id="btn_download" disabled
                        class="w-full text-secondary-foreground hover:bg-secondary/80 transition duration-300 py-3 rounded-sm font-semibold mt-4 disabled:opacity-50 disabled:cursor-not-allowed">
                    DOWNLOAD SELECTED
                </button>
            </div>
        </div>
    </main>
</body>
</html>